var cov_5c2fjguab=function(){var path="/Users/russellsavage/Desktop/ACA/Advanced/Heath/chai-mocha-basics/src/module.js",hash="468e63a8969b63918e70b402530ee1ec59c939f9",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/russellsavage/Desktop/ACA/Advanced/Heath/chai-mocha-basics/src/module.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:39}},"1":{start:{line:4,column:18},end:{line:4,column:49}},"2":{start:{line:6,column:1},end:{line:8,column:2}},"3":{start:{line:7,column:3},end:{line:7,column:46}},"4":{start:{line:10,column:22},end:{line:44,column:2}},"5":{start:{line:46,column:20},end:{line:46,column:22}},"6":{start:{line:48,column:1},end:{line:65,column:2}},"7":{start:{line:49,column:3},end:{line:64,column:4}},"8":{start:{line:50,column:5},end:{line:52,column:6}},"9":{start:{line:51,column:7},end:{line:51,column:15}},"10":{start:{line:54,column:5},end:{line:58,column:6}},"11":{start:{line:56,column:7},end:{line:56,column:70}},"12":{start:{line:57,column:7},end:{line:57,column:15}},"13":{start:{line:60,column:5},end:{line:63,column:6}},"14":{start:{line:62,column:7},end:{line:62,column:32}},"15":{start:{line:67,column:1},end:{line:72,column:2}},"16":{start:{line:68,column:17},end:{line:68,column:54}},"17":{start:{line:69,column:3},end:{line:69,column:20}},"18":{start:{line:70,column:3},end:{line:70,column:24}},"19":{start:{line:71,column:3},end:{line:71,column:118}},"20":{start:{line:76,column:1},end:{line:76,column:44}}},fnMap:{"0":{name:"getRemoteResources",decl:{start:{line:3,column:15},end:{line:3,column:33}},loc:{start:{line:3,column:61},end:{line:77,column:1}},line:3}},branchMap:{"0":{loc:{start:{line:6,column:1},end:{line:8,column:2}},type:"if",locations:[{start:{line:6,column:1},end:{line:8,column:2}},{start:{line:6,column:1},end:{line:8,column:2}}],line:6},"1":{loc:{start:{line:50,column:5},end:{line:52,column:6}},type:"if",locations:[{start:{line:50,column:5},end:{line:52,column:6}},{start:{line:50,column:5},end:{line:52,column:6}}],line:50},"2":{loc:{start:{line:54,column:5},end:{line:58,column:6}},type:"if",locations:[{start:{line:54,column:5},end:{line:58,column:6}},{start:{line:54,column:5},end:{line:58,column:6}}],line:54},"3":{loc:{start:{line:60,column:5},end:{line:63,column:6}},type:"if",locations:[{start:{line:60,column:5},end:{line:63,column:6}},{start:{line:60,column:5},end:{line:63,column:6}}],line:60}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},f:{"0":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_5c2fjguab.s[0]++;module.exports={getRemoteResources};async function getRemoteResources(sftpClient,sftpPath,log){cov_5c2fjguab.f[0]++;const fileList=(cov_5c2fjguab.s[1]++,await sftpClient.list(sftpPath));cov_5c2fjguab.s[2]++;if(!fileList.length){cov_5c2fjguab.b[0][0]++;cov_5c2fjguab.s[3]++;throw new Error("No files in "+sftpPath);}else{cov_5c2fjguab.b[0][1]++;}const filePatterns=(cov_5c2fjguab.s[4]++,[// Sustainalytics
{name:'ref_data',pattern:/^\d\.\d\sReference\sdata/},{name:'esg_focus',pattern:/^\d\.\d\sESG\sFocus/},// MorningStar
{name:'esg_fc',pattern:/^ESG_GROUP1_FC/},{name:'esg_fe',pattern:/^ESG_GROUP1_FE/},{name:'esg_fm',pattern:/^ESG_GROUP1_FM/},{name:'esg_oe',pattern:/^ESG_GROUP1_OE/},{name:'esg_ut',pattern:/^ESG_GROUP1_UT/},{name:'fund_basic_fc',pattern:/^FundBasic_FC/},{name:'fund_basic_fe',pattern:/^FundBasic_FE/},{name:'fund_basic_fm',pattern:/^FundBasic_FM/},{name:'fund_basic_ut',pattern:/^FundBasic_UT/},{name:'fund_basic_oe',pattern:/^FundBasic_OE/},// Yodlee
{name:'bank_account',pattern:/_BANK_ACCT/},{name:'bank_transaction',pattern:/_BANK_TRANS/},{name:'card_account',pattern:/_CARD_ACCT/},{name:'card_statement',pattern:/_CARD_STMT/},{name:'card_transaction',pattern:/_CARD_TRANS/},{name:'crc_exch_rate',pattern:/_CRC_EXCH_RATE/},{name:'insurance_account',pattern:/_INS_ACCT/},{name:'insurance_ann',pattern:/_INS_ANN/},{name:'insurance_mutual',pattern:/_INS_MUT/},{name:'insurance_statement',pattern:/_INS_STMT/},{name:'insurance_transaction',pattern:/_INS_TRANS/},{name:'investment_account',pattern:/_INV_ACCT/},{name:'investment_transaction',pattern:/_INV_TRANS/},{name:'rew_pgm',pattern:/_REW_PGM/},{name:'unreg_user',pattern:/_UNREG_USER/},{name:'investment_holding',pattern:/_INV_HOLD/}]);let downloadList=(cov_5c2fjguab.s[5]++,{});// For Each pattern
cov_5c2fjguab.s[6]++;for(const file of fileList){cov_5c2fjguab.s[7]++;for(const{name,pattern}of filePatterns){cov_5c2fjguab.s[8]++;if(!pattern.test(file.name)){cov_5c2fjguab.b[1][0]++;cov_5c2fjguab.s[9]++;continue;}else{cov_5c2fjguab.b[1][1]++;}cov_5c2fjguab.s[10]++;if(!downloadList[name]){cov_5c2fjguab.b[2][0]++;cov_5c2fjguab.s[11]++;// The file is a new name and can be directly added
downloadList=Object.assign({},downloadList,{[name]:file});cov_5c2fjguab.s[12]++;continue;}else{cov_5c2fjguab.b[2][1]++;}cov_5c2fjguab.s[13]++;if(downloadList[name].modifyTime<file.modifyTime){cov_5c2fjguab.b[3][0]++;cov_5c2fjguab.s[14]++;// Previously retained file is older than the current file
downloadList[name]=file;}else{cov_5c2fjguab.b[3][1]++;}}}cov_5c2fjguab.s[15]++;for(const{name:fileName}of Object.values(downloadList)){let message=(cov_5c2fjguab.s[16]++,`Retrieving remote file: ${fileName}`);cov_5c2fjguab.s[17]++;log.push(message);cov_5c2fjguab.s[18]++;winston.info(message);cov_5c2fjguab.s[19]++;await sftpClient.fastGet(`${sftpPath}/${fileName}`,path.resolve(`${process.cwd()}/scripts/downloads/${fileName}`));}// Indicates that the associated resources have updates
// the ETL process for that resource group should run
cov_5c2fjguab.s[20]++;return Object.keys(downloadList).length>0;}