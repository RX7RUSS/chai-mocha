var cov_64fvxstb8=function(){var path="/Users/russellsavage/Desktop/ACA/Advanced/Heath/chai-mocha-basics/src/revised-block.js",hash="77209af642b8a1bc6da2e8c3803c69f1c855df5b",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/russellsavage/Desktop/ACA/Advanced/Heath/chai-mocha-basics/src/revised-block.js",statementMap:{"0":{start:{line:1,column:13},end:{line:1,column:28}},"1":{start:{line:2,column:0},end:{line:2,column:39}},"2":{start:{line:5,column:17},end:{line:5,column:48}},"3":{start:{line:7,column:2},end:{line:9,column:3}},"4":{start:{line:8,column:4},end:{line:8,column:47}},"5":{start:{line:11,column:23},end:{line:45,column:3}},"6":{start:{line:47,column:2},end:{line:47,column:66}},"7":{start:{line:47,column:37},end:{line:47,column:65}},"8":{start:{line:49,column:21},end:{line:49,column:23}},"9":{start:{line:51,column:2},end:{line:68,column:3}},"10":{start:{line:52,column:4},end:{line:67,column:5}},"11":{start:{line:53,column:6},end:{line:55,column:7}},"12":{start:{line:54,column:8},end:{line:54,column:16}},"13":{start:{line:57,column:6},end:{line:61,column:7}},"14":{start:{line:59,column:8},end:{line:59,column:71}},"15":{start:{line:60,column:8},end:{line:60,column:16}},"16":{start:{line:63,column:6},end:{line:66,column:7}},"17":{start:{line:65,column:8},end:{line:65,column:33}},"18":{start:{line:70,column:2},end:{line:75,column:3}},"19":{start:{line:71,column:18},end:{line:71,column:55}},"20":{start:{line:72,column:4},end:{line:72,column:21}},"21":{start:{line:73,column:4},end:{line:73,column:25}},"22":{start:{line:74,column:4},end:{line:74,column:119}},"23":{start:{line:79,column:2},end:{line:79,column:45}}},fnMap:{"0":{name:"getRemoteResources",decl:{start:{line:4,column:15},end:{line:4,column:33}},loc:{start:{line:4,column:61},end:{line:80,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:47,column:27},end:{line:47,column:28}},loc:{start:{line:47,column:37},end:{line:47,column:65}},line:47}},branchMap:{"0":{loc:{start:{line:7,column:2},end:{line:9,column:3}},type:"if",locations:[{start:{line:7,column:2},end:{line:9,column:3}},{start:{line:7,column:2},end:{line:9,column:3}}],line:7},"1":{loc:{start:{line:53,column:6},end:{line:55,column:7}},type:"if",locations:[{start:{line:53,column:6},end:{line:55,column:7}},{start:{line:53,column:6},end:{line:55,column:7}}],line:53},"2":{loc:{start:{line:57,column:6},end:{line:61,column:7}},type:"if",locations:[{start:{line:57,column:6},end:{line:61,column:7}},{start:{line:57,column:6},end:{line:61,column:7}}],line:57},"3":{loc:{start:{line:63,column:6},end:{line:66,column:7}},type:"if",locations:[{start:{line:63,column:6},end:{line:66,column:7}},{start:{line:63,column:6},end:{line:66,column:7}}],line:63}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const path=(cov_64fvxstb8.s[0]++,require('path'));cov_64fvxstb8.s[1]++;module.exports={getRemoteResources};async function getRemoteResources(sftpClient,sftpPath,log){cov_64fvxstb8.f[0]++;let fileList=(cov_64fvxstb8.s[2]++,await sftpClient.list(sftpPath));cov_64fvxstb8.s[3]++;if(!fileList.length){cov_64fvxstb8.b[0][0]++;cov_64fvxstb8.s[4]++;throw new Error("No files in "+sftpPath);}else{cov_64fvxstb8.b[0][1]++;}const filePatterns=(cov_64fvxstb8.s[5]++,[// Sustainalytics
{name:'ref_data',pattern:/^\d\.\d\sReference\sdata/},{name:'esg_focus',pattern:/^\d\.\d\sESG\sFocus/},// MorningStar
{name:'esg_fc',pattern:/^ESG_Group1_FC/},{name:'esg_fe',pattern:/^ESG_Group1_FE/},{name:'esg_fm',pattern:/^ESG_Group1_FM/},{name:'esg_oe',pattern:/^ESG_Group1_OE/},{name:'esg_ut',pattern:/^ESG_Group1_UT/},{name:'fund_basic_fc',pattern:/^FundBasic_FC/},{name:'fund_basic_fe',pattern:/^FundBasic_FE/},{name:'fund_basic_fm',pattern:/^FundBasic_FM/},{name:'fund_basic_ut',pattern:/^FundBasic_UT/},{name:'fund_basic_oe',pattern:/^FundBasic_OE/},// Yodlee
{name:'bank_account',pattern:/_BANK_ACCT/},{name:'bank_transaction',pattern:/_BANK_TRANS/},{name:'card_account',pattern:/_CARD_ACCT/},{name:'card_statement',pattern:/_CARD_STMT/},{name:'card_transaction',pattern:/_CARD_TRANS/},{name:'crc_exch_rate',pattern:/_CRC_EXCH_RATE/},{name:'insurance_account',pattern:/_INS_ACCT/},{name:'insurance_ann',pattern:/_INS_ANN/},{name:'insurance_mutual',pattern:/_INS_MUT/},{name:'insurance_statement',pattern:/_INS_STMT/},{name:'insurance_transaction',pattern:/_INS_TRANS/},{name:'investment_account',pattern:/_INV_ACCT/},{name:'investment_transaction',pattern:/_INV_TRANS/},{name:'rew_pgm',pattern:/_REW_PGM/},{name:'unreg_user',pattern:/_UNREG_USER/},{name:'investment_holding',pattern:/_INV_HOLD/}]);cov_64fvxstb8.s[6]++;fileList=fileList.sort((a,b)=>{cov_64fvxstb8.f[1]++;cov_64fvxstb8.s[7]++;return b.name.localeCompare(a.name);});let downloadList=(cov_64fvxstb8.s[8]++,{});// For Each pattern
cov_64fvxstb8.s[9]++;for(const file of fileList){cov_64fvxstb8.s[10]++;for(const{name,pattern}of filePatterns){cov_64fvxstb8.s[11]++;if(!pattern.test(file.name)){cov_64fvxstb8.b[1][0]++;cov_64fvxstb8.s[12]++;continue;}else{cov_64fvxstb8.b[1][1]++;}cov_64fvxstb8.s[13]++;if(!downloadList[name]){cov_64fvxstb8.b[2][0]++;cov_64fvxstb8.s[14]++;// The file is a new name and can be directly added
downloadList=Object.assign({},downloadList,{[name]:file});cov_64fvxstb8.s[15]++;continue;}else{cov_64fvxstb8.b[2][1]++;}cov_64fvxstb8.s[16]++;if(downloadList[name].modifyTime<file.modifyTime){cov_64fvxstb8.b[3][0]++;cov_64fvxstb8.s[17]++;// Previously retained file is older than the current file
downloadList[name]=file;}else{cov_64fvxstb8.b[3][1]++;}}}cov_64fvxstb8.s[18]++;for(const{name:fileName}of Object.values(downloadList)){let message=(cov_64fvxstb8.s[19]++,`Retrieving remote file: ${fileName}`);cov_64fvxstb8.s[20]++;log.push(message);cov_64fvxstb8.s[21]++;winston.info(message);cov_64fvxstb8.s[22]++;await sftpClient.fastGet(`${sftpPath}/${fileName}`,path.resolve(`${process.cwd()}/scripts/downloads/${fileName}`));}// Indicates that the associated resources have updates
// the ETL process for that resource group should run
cov_64fvxstb8.s[23]++;return Object.keys(downloadList).length>0;}